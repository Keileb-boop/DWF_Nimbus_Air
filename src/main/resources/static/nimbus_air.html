<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nimbus Air - Inicio</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <style>
        * {
          box-sizing: border-box;
          margin: 0;
          padding: 0;
          font-family: 'Poppins', sans-serif;
        }

        body {
          background: linear-gradient(135deg, #eef8fc 0%, #b6e2f0 100%);
          min-height: 100vh;
          display: flex;
          flex-direction: column;
        }

        .header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          background-color: #b6e2f0;
          padding: 15px 30px;
          border-bottom: 2px solid #8ac4d0;
          flex-wrap: wrap;
          gap: 15px;
        }

        .logo {
          display: flex;
          align-items: center;
          gap: 10px;
          font-weight: bold;
          font-size: 20px;
          color: #003b58;
        }

        .logo img {
          width: 50px;
          height: 50px;
        }

        .header-buttons {
          display: flex;
          gap: 15px;
        }

        .header-buttons button {
          background: none;
          border: 2px solid #3b82f6;
          color: #3b82f6;
          padding: 8px 15px;
          border-radius: 20px;
          cursor: pointer;
          font-weight: 500;
          transition: all 0.3s ease;
        }

        .header-buttons button:hover {
          background: #3b82f6;
          color: white;
        }

        .user-section {
          display: flex;
          align-items: center;
          gap: 15px;
          color: #003b58;
          font-weight: 500;
        }

        .user-info {
          background: rgba(255, 255, 255, 0.3);
          padding: 8px 15px;
          border-radius: 20px;
          border: 1px solid #8ac4d0;
        }

        .btn-logout {
          background: #ef4444;
          color: white;
          border: none;
          padding: 8px 15px;
          border-radius: 20px;
          cursor: pointer;
          font-weight: 500;
          transition: background 0.3s ease;
        }

        .btn-logout:hover {
          background: #dc2626;
        }

        .social-icons {
          display: flex;
          gap: 15px;
        }

        .social-icons a {
          color: #000000;
          text-decoration: none;
          transition: transform 0.3s ease;
        }

        .social-icons a:hover {
          transform: scale(1.2);
        }

        .main-content {
          flex: 1;
          padding: 40px 20px;
          text-align: center;
          max-width: 1200px;
          margin: 0 auto;
          width: 100%;
        }

        .main-content h1 {
          color: #003b58;
          font-size: 2.5rem;
          margin-bottom: 30px;
          text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
        }

        .gallery {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
          gap: 20px;
          margin-bottom: 40px;
        }

        .gallery img {
          width: 100%;
          height: 250px;
          object-fit: cover;
          border-radius: 15px;
          box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
          transition: transform 0.3s ease;
        }

        .gallery img:hover {
          transform: scale(1.05);
        }

        .info-reserva {
          background: white;
          padding: 30px;
          border-radius: 15px;
          box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
          margin-top: 20px;
        }

        .info-reserva p {
          margin-bottom: 20px;
          color: #333;
          line-height: 1.6;
        }

        .info-reserva p strong {
          color: #003b58;
          font-size: 1.2rem;
        }

        .btn-reserva {
          background: #3b82f6;
          color: white;
          border: none;
          padding: 15px 30px;
          border-radius: 25px;
          font-size: 1.1rem;
          font-weight: bold;
          cursor: pointer;
          transition: all 0.3s ease;
          box-shadow: 0 4px 10px rgba(59, 130, 246, 0.3);
          margin: 5px;
        }

        .btn-reserva:hover {
          background: #2563eb;
          transform: translateY(-2px);
          box-shadow: 0 6px 15px rgba(59, 130, 246, 0.4);
        }

        .btn-ver-reservas {
          background: #10b981;
          color: white;
          border: none;
          padding: 15px 30px;
          border-radius: 25px;
          font-size: 1.1rem;
          font-weight: bold;
          cursor: pointer;
          transition: all 0.3s ease;
          box-shadow: 0 4px 10px rgba(16, 185, 129, 0.3);
          margin: 5px;
        }

        .btn-ver-reservas:hover {
          background: #059669;
          transform: translateY(-2px);
          box-shadow: 0 6px 15px rgba(16, 185, 129, 0.4);
        }

        .btn-admin-reservas {
            background: #8b5cf6;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(139, 92, 246, 0.3);
            margin: 5px;
        }

        .btn-admin-reservas:hover {
            background: #7c3aed;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(139, 92, 246, 0.4);
        }

        .btn-admin-sugerencias {
            background: #06b6d4;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(6, 182, 212, 0.3);
            margin: 5px;
        }

        .btn-admin-sugerencias:hover {
            background: #0891b2;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(6, 182, 212, 0.4);
        }

        .botones-container {
          display: flex;
          gap: 15px;
          justify-content: center;
          flex-wrap: wrap;
          margin-top: 20px;
        }

        .footer {
          text-align: center;
          padding: 20px;
          background: #b6e2f0;
          color: #333;
          margin-top: auto;
        }

        @media (max-width: 768px) {
          .header {
            flex-direction: column;
            text-align: center;
          }

          .main-content h1 {
            font-size: 2rem;
          }

          .gallery {
            grid-template-columns: 1fr;
          }

          .botones-container {
            flex-direction: column;
            align-items: center;
          }
        }
    </style>
</head>
<body>
<header class="header">
    <div class="logo">
        <img src="img/nimbusair2.png" alt="Nimbus Air Logo">
        <span>NIMBUS AIR</span>
    </div>

    <div class="header-buttons">
        <button onclick="irASugerencias()">Envía sugerencias</button>
        <button onclick="mostrarAcercaDe()">Acerca de nosotros</button>
    </div>

    <div class="user-section">
        <div class="user-info" id="userInfo">
            Cargando...
        </div>
        <button class="btn-logout" onclick="cerrarSesion()">
            <i class="bi bi-box-arrow-right"></i> Cerrar Sesión
        </button>
    </div>

    <div class="social-icons">
        <a href="#"><i class="bi bi-instagram" style="font-size: 24px; color: #000000;"></i></a>
        <a href="#"><i class="bi bi-whatsapp" style="font-size: 24px; color: #000000;"></i></a>
        <a href="#"><i class="bi bi-twitter-x" style="font-size: 24px; color: #000000;"></i></a>
        <a href="#"><i class="bi bi-facebook" style="font-size: 24px; color: #000000;"></i></a>
    </div>
</header>

<main class="main-content">
    <h1>Viaja a los mejores lugares turísticos en el mundo</h1>

    <div class="gallery">
        <img src="img/img1.jpg" alt="Lugar 1">
        <img src="img/img2.jpg" alt="Lugar 2">
        <img src="img/img5.jpg" alt="Lugar 3">
        <img src="img/img7.jpg" alt="Lugar 4">
        <img src="img/img6.jpeg" alt="Lugar 5">
        <img src="img/img4.jpg" alt="Lugar 6">
    </div>

    <div class="info-reserva">
        <p><strong>Los mejores viajes por el mundo, gracias a nuestra agencia Nimbus Air</strong></p>
        <p>Nuestra agencia lo llevará por los lugares más famosos y fantásticos que haya visto, haga una reserva y disfrute de viajes por distintas partes del mundo, donde usted elija ir!</p>

        <div class="botones-container" id="botonesContainer">
            <button class="btn-ver-reservas" onclick="verReservas()">
                <i class="bi bi-eye"></i> Ver Mis Reservas
            </button>
            <button class="btn-reserva" onclick="irAReservas()">Reservar Viaje</button>
        </div>
    </div>
</main>

<footer class="footer">
    © 2025 Nimbus Air. Todos los derechos reservados.
</footer>

<script>
    document.addEventListener('DOMContentLoaded', function() {
      const token = localStorage.getItem('jwtToken');
      const userEmail = localStorage.getItem('userEmail');
      const userName = localStorage.getItem('userName');
      const userRole = localStorage.getItem('userRole');

      if (!token || !userEmail) {
        alert('Debes iniciar sesión para acceder a esta página');
        window.location.href = 'login.html';
        return;
      }

      document.getElementById('userInfo').textContent = userName + ' (' + userEmail + ')';

      if (userRole === 'ADMIN') {
        mostrarBotonesAdmin();
      }
    });

    function mostrarBotonesAdmin() {
        const botonesContainer = document.getElementById('botonesContainer');

        const botonAdminReservas = document.createElement('button');
        botonAdminReservas.className = 'btn-admin-reservas';
        botonAdminReservas.innerHTML = '<i class="bi bi-list-check"></i> Ver Todas las Reservas';
        botonAdminReservas.onclick = verTodasLasReservas;

        const botonAdminSugerencias = document.createElement('button');
        botonAdminSugerencias.className = 'btn-admin-sugerencias';
        botonAdminSugerencias.innerHTML = '<i class="bi bi-chat-dots"></i> Ver Todas las Sugerencias';
        botonAdminSugerencias.onclick = verTodasLasSugerencias;

        botonesContainer.insertBefore(botonAdminSugerencias, botonesContainer.firstChild);
        botonesContainer.insertBefore(botonAdminReservas, botonesContainer.firstChild);
    }

    function verTodasLasReservas() {
        const token = localStorage.getItem('jwtToken');

        fetch('http://localhost:8080/api/reservas/admin/todas', {
            method: 'GET',
            headers: {
                'Authorization': 'Bearer ' + token,
                'Content-Type': 'application/json'
            }
        })
        .then(response => {
            if (response.ok) {
                return response.json();
            } else if (response.status === 403) {
                throw new Error('No tienes permisos de administrador');
            } else {
                throw new Error('Error al obtener reservas');
            }
        })
        .then(reservas => {
            localStorage.setItem('adminTodasLasReservas', JSON.stringify(reservas));
            window.location.href = 'admin_reservas.html';
        })
        .catch(error => {
            console.error('Error:', error);
            alert(error.message);
        });
    }

    function verTodasLasSugerencias() {
        const token = localStorage.getItem('jwtToken');

        fetch('http://localhost:8080/api/sugerencias/admin/todas', {
            method: 'GET',
            headers: {
                'Authorization': 'Bearer ' + token,
                'Content-Type': 'application/json'
            }
        })
        .then(response => {
            if (response.ok) {
                return response.json();
            } else if (response.status === 403) {
                throw new Error('No tienes permisos de administrador');
            } else {
                throw new Error('Error al obtener sugerencias');
            }
        })
        .then(sugerencias => {
            localStorage.setItem('adminTodasLasSugerencias', JSON.stringify(sugerencias));
            window.location.href = 'admin_sugerencias.html';
        })
        .catch(error => {
            console.error('Error:', error);
            alert(error.message);
        });
    }

    function irASugerencias() {
      window.location.href = 'sugerencias.html';
    }

    function irAReservas() {
      window.location.href = 'reserva.html';
    }

    function verReservas() {
      const token = localStorage.getItem('jwtToken');

      if (!token) {
        alert('Debes iniciar sesión para ver tus reservas');
        window.location.href = 'login.html';
        return;
      }

      fetch('http://localhost:8080/api/reservas', {
        method: 'GET',
        headers: {
          'Authorization': 'Bearer ' + token,
          'Content-Type': 'application/json'
        }
      })
      .then(response => {
        if (response.ok) {
          return response.json();
        } else {
          throw new Error('Error al obtener reservas');
        }
      })
      .then(data => {
        if (data.reservas && data.reservas.length > 0) {
          localStorage.setItem('todasLasReservas', JSON.stringify(data.reservas));
          window.location.href = 'detallereserva.html';
        } else {
          alert('No tienes reservas aún. Crea tu primera reserva!');
          window.location.href = 'reserva.html';
        }
      })
      .catch(error => {
        console.error('Error:', error);
        alert('No se pudieron cargar las reservas. Serás redirigido a la página de reservas.');
        window.location.href = 'reserva.html';
      });
    }

    function cerrarSesion() {
      if (confirm('Estas seguro de que quieres cerrar sesión?')) {
        localStorage.removeItem('jwtToken');
        localStorage.removeItem('userEmail');
        localStorage.removeItem('userName');
        localStorage.removeItem('userId');
        localStorage.removeItem('userRole');
        localStorage.removeItem('reservaReciente');
        localStorage.removeItem('todasLasReservas');

        alert('Sesión cerrada correctamente');
        window.location.href = 'login.html';
      }
    }

    function mostrarAcercaDe() {
      window.location.href = 'nosotros.html';
    }
</script>
</body>
</html>